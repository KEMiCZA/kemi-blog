---
import "../styles/global.css";
import "@fontsource/vt323";
import ThemeToggle from "../components/ThemeToggle.astro";

interface Props {
    title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="description" content="Astro description" />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <meta name="generator" content={Astro.generator} />
        <title>{title}</title>
        <script is:inline>
            // Immediate theme execution to prevent FOUC
            const theme = (() => {
              if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
                return localStorage.getItem('theme');
              }
              if (window.matchMedia('(prefers-color-scheme: light)').matches) {
                return 'light';
              }
              return 'dark';
            })();

            if (theme === 'light') {
              document.documentElement.classList.add('light');
            } else {
              document.documentElement.classList.remove('light');
            }
            // Persist detected theme if not present
            if (typeof localStorage !== 'undefined') {
                localStorage.setItem('theme', theme);
            }
        </script>
    </head>
    <body
        class="min-h-screen flex flex-col p-4 md:p-8 max-w-4xl mx-auto relative"
    >
        <header
            class="mb-8 border-b-2 border-accent-secondary/50 pb-4 flex justify-between items-end"
        >
            <div>
                <h1
                    class="text-3xl md:text-5xl font-bold glitch text-accent-primary"
                    data-text="kemicza"
                >
                    kemicza
                </h1>
                <p class="text-sm opacity-80 text-accent-secondary">
                    System.Status: <span class="text-green-400">ONLINE</span>
                </p>
            </div>
            <nav class="flex gap-4 text-xl flex-wrap justify-end">
                <a
                    href="/"
                    class="hover:bg-accent-secondary hover:text-terminal-bg px-2 py-1 no-underline"
                    data-astro-prefetch>[HOME]</a
                >
                <a
                    href="/about"
                    class="hover:bg-accent-secondary hover:text-terminal-bg px-2 py-1 no-underline"
                    data-astro-prefetch>[BIO]</a
                >
                <a
                    href="/blog"
                    class="hover:bg-accent-secondary hover:text-terminal-bg px-2 py-1 no-underline"
                    data-astro-prefetch>[BLOG]</a
                >
                <a
                    href="/projects"
                    class="hover:bg-accent-secondary hover:text-terminal-bg px-2 py-1 no-underline"
                    data-astro-prefetch>[PROJECTS]</a
                >
                <ThemeToggle />
            </nav>
        </header>

        <main class="flex-grow">
            <slot />
        </main>

        <footer
            class="mt-12 pt-4 border-t border-terminal-dim text-center text-sm opacity-60 text-terminal-dim"
        >
            <p>&copy; {new Date().getFullYear()} // EOF</p>
        </footer>
    </body>
</html>
